# -*- coding: utf-8 -*-
"""Logic.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DKnvYZEERcvwLtu-hgl_Dd_QK3uFSwOC
"""

from utils import get_valid_answer
from questions import questions


class MBTIScorer:
    """Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÛŒ Ø§Ù…ØªÛŒØ§Ø²Ù‡Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø¨Ø¹Ø§Ø¯ Ø´Ø®ØµÛŒØªÛŒ MBTI"""

    def __init__(self):
        self.scores = {
            "E": 0, "I": 0,
            "S": 0, "N": 0,
            "T": 0, "F": 0,
            "J": 0, "P": 0
        }

    def update_score(self, answer, dimension):
        """Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø± Ø§Ø³Ø§Ø³ Ù¾Ø§Ø³Ø® Ùˆ Ø¨ÙØ¹Ø¯ Ø´Ø®ØµÛŒØªÛŒ"""
        if dimension == "E/I":
            if answer == 1:
                self.scores["E"] += 1
            elif answer == 3:
                self.scores["I"] += 1
        elif dimension == "S/N":
            if answer == 1:
                self.scores["S"] += 1
            elif answer == 3:
                self.scores["N"] += 1
        elif dimension == "T/F":
            if answer == 1:
                self.scores["T"] += 1
            elif answer == 3:
                self.scores["F"] += 1
        elif dimension == "J/P":
            if answer == 1:
                self.scores["J"] += 1
            elif answer == 3:
                self.scores["P"] += 1

    def calculate(self, answers, questions):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒÛŒ Ù†Ù‡Ø§ÛŒÛŒ Ø§Ù…ØªÛŒØ§Ø²Ù‡Ø§"""
        for ans, q in zip(answers, questions):
            self.update_score(ans, q["dimension"])
        return self.scores

    def determine_personality(self):
        """ØªØ´Ø®ÛŒØµ ØªÛŒÙ¾ Ø´Ø®ØµÛŒØªÛŒ Ù†Ù‡Ø§ÛŒÛŒ"""
        return (
            ("E" if self.scores["E"] >= self.scores["I"] else "I") +
            ("S" if self.scores["S"] >= self.scores["N"] else "N") +
            ("T" if self.scores["T"] >= self.scores["F"] else "F") +
            ("J" if self.scores["J"] >= self.scores["P"] else "P")
        )


class MBTITest:
    """Ú©Ù„Ø§Ø³ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª MBTI"""

    def __init__(self, questions):
        self.questions = questions
        self.answers = []
        self.scorer = MBTIScorer()

    def ask_question(self, index, question):
        """Ù¾Ø±Ø³ÛŒØ¯Ù† ÛŒÚ© Ø³Ø¤Ø§Ù„ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±"""
        print(f"\nØ³Ø¤Ø§Ù„ {index + 1}: {question['question']}")
        print("Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§: 1) Ù…ÙˆØ§ÙÙ‚Ù…  |  2) ØªØ§Ø­Ø¯ÛŒ  |  3) Ù…Ø®Ø§Ù„ÙÙ…")
        return get_valid_answer(["Ù…ÙˆØ§ÙÙ‚Ù…", "ØªØ§Ø­Ø¯ÛŒ", "Ù…Ø®Ø§Ù„ÙÙ…"])

    def conduct_test(self):
        """Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ ØªØ³Øª"""
        print("ğŸ’¡ ØªØ³Øª Ø´Ø®ØµÛŒØªÛŒ MBTI Ø¢ØºØ§Ø² Ø´Ø¯!\n")
        for i, q in enumerate(self.questions):
            answer = self.ask_question(i, q)
            self.answers.append(answer)

        print("\nğŸ”¹ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬ ...")
        scores = self.scorer.calculate(self.answers, self.questions)
        personality = self.scorer.determine_personality()

        self.show_result(personality)

    def show_result(self, personality):
        """Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡â€ŒÛŒ Ù†Ù‡Ø§ÛŒÛŒ"""
        print("\nâœ… ØªØ³Øª Ø´Ù…Ø§ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯!")
        print(f"âœ¨ ØªÛŒÙ¾ Ø´Ø®ØµÛŒØªÛŒ Ø´Ù…Ø§: {personality}")
        print("ğŸ™ Ù…Ù…Ù†ÙˆÙ† Ú©Ù‡ Ø¯Ø± ØªØ³Øª MBTI Ø´Ø±Ú©Øª Ú©Ø±Ø¯ÛŒØ¯.")


if __name__ == "__main__":
    test = MBTITest(questions)
    test.conduct_test()
